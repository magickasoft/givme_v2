"use strict";function SettingsProfileCtrl(e,t,a,i,o,n,l){n.getOrRedirect().then(function(t){e.profileData=t,e.newPhoto=void 0,e.$watchCollection("profileData",function(){n.saveProfile(e.profileData)}),e.$watchCollection("profileData.tags",function(){n.saveProfile(e.profileData)}),e.$watchCollection("profileData.languages",function(){n.saveProfile(e.profileData)}),e.$watchCollection("profileData.photos",function(){n.saveProfile(e.profileData)}),e.newImage={},e.deletedImage={},e.addIceBreaker=function(t){if("blur"==t||13==t.keyCode){if(e.newIceBreaker.text.length<1)return;e.profileData.tags.push(e.newIceBreaker.text),e.newIceBreaker.text=""}},e.deleteIceBreaker=function(t){e.profileData.tags.splice(e.profileData.tags.indexOf(t),1)},e.addLanguage=function(t){if("blur"==t||13==t.keyCode){if(e.newLanguage.text.length<1)return;e.profileData.languages.push(e.newLanguage.text),e.newLanguage.text=""}},e.deleteLanguage=function(t){e.profileData.languages.splice(e.profileData.languages.indexOf(t),1)},e.pictureItems=e.profileData.photos,e.iceBreakers={items:e.profileData.tags,shouldShowReorder:!1,listCanSwipe:!0,moveItem:function(e,t,a){this.items.splice(t,1),this.items.splice(a,0,e)},deleteItem:function(e){this.items.splice(e,1)}},e.languageItems={items:e.profileData.languages,shouldShowReorder:!1,listCanSwipe:!0,moveItem:function(e,t,a){this.items.splice(t,1),this.items.splice(a,0,e)},deleteItem:function(e){this.items.splice(e,1)}},e.submitForm=function(){var t=new FormData($("#pictureForm")[0]);n.savePhoto(t).then(function(t){e.profileData.photos=t.photos,e.newImage=e.profileData.photos[e.profileData.photos.length-1],e.pictureItems.push(e.profileData.photos[e.profileData.photos.length-1]),setTimeout(function(){e.$apply()},50)})["finally"](function(){$(".settings .slider-thumb li:nth-last-child(2)").addClass("animated pulse visible")})},e.selectImage=function(){l.getPicture({quality:100,sourceType:navigator.camera.PictureSourceType.PHOTOLIBRARY}).then(function(t){e.profileData.photos.push({src:t,active:!1})})["catch"](function(e){console.error(e)})},e.newIceBreaker={text:""},e.newLanguage={text:""},e.activeImage=void 0,e.handleImage=function(t){return e.newImage={},t!=e.activeImage?void(e.activeImage=t):void n.deletePhoto(t.id).then(function(a){e.profileData.photos=a.photos,e.deletedImage=e.pictureItems[e.pictureItems.indexOf(t)],e.activeImage={},setTimeout(function(){e.pictureItems.splice(e.pictureItems.indexOf(t),1),e.$apply()},500)})},e.imageClass=function(t){return t==e.newImage?"image-pop":t==e.deletedImage?"image-deleted":void 0},e.isActiveImage=function(t){return t==e.activeImage?"active":t==e.deletedImage?"deleted":void 0}})["catch"](function(e){console.error(e)})}angular.module("givmeApp.controllers").controller("SettingsProfileCtrl",SettingsProfileCtrl);